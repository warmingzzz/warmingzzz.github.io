---
layout: post
title: 'UDP如何做可靠传输'
date: 2020-9-17
author: Warmingzzz
cover: 'http://on2171g4d.bkt.clouddn.com/jekyll-banner.png'
tags: 面试

---

## UDP如何做可靠传输

### 概念

UDP不输入连接协议，具有资源消耗少，处理速度快的优点，所以通常音频，视频和普通数据在传送时，使用UDP较多，因为即使丢失少量的包，也不会对结果产生较大的影响。



传输层无法保证数据的可靠传输，只能通过应用层来实现了。现实的方式可以参照tcp可靠性传输的方式，只是实现不在传输层，而是在应用层。



最简单的方式是在应用层模仿传输层TCP的可靠性传输。下面不考虑拥塞处理，可靠UDP的简单设计

1、添加seq/ack机制，确保数据发送到对端

2、添加发送和接收缓冲区，主要是用户的超时重传

3、添加超时重传机制

详细说明：送端发送数据时，生产一个随机的seq=x，然后每一片按照数据大小分配seq。数据到达接受端后接受端放入缓存，发送一个ack=x的包，表示对方已经收到了数据。发送端收到了ack包后，删除缓冲区对应的数据。时间到之后，定时任务检查是否需要重传数据。



目前有如下开源应用程序利用udp实现了可靠数据传输。分别为RUDP、RTP、UDT。

## 开源程序

### 1、RUDP

RUDP提供一组数据服务质量增强机制，如拥塞控制的改进，重发机制及谈化服务器算法等、从而在丢包和网络拥塞的情况下，RTP客户机（实时位置）面前呈现的就是一个高质量的RTP流。在不干扰协议的实时特性的同时，可靠UDP的拥堵机制允许TCp方式下的流控制行为。

### 2、RTP（Real Time Protocol）

RTP为数据提供了具有实时特性的端对端传送服务，如在组播或单播网络服务的交互式视频或模拟数据。

### 3、UDT（UDP-based Date Transfer Protocal）

基于UDP的数据传输协议，是一种互联网数据传输协议。UDT的主要目的是支持高速广域网上的海量数据传输，而在互联网上的标准数据传输协议TCP在高宽带长距离网络上性能很差。

