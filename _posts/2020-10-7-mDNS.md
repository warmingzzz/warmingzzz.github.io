---
layout: post
title: '网络协议之mDNS'
date: 2020-10-7
author: Warmingzzz
cover: 'http://on2171g4d.bkt.clouddn.com/jekyll-banner.png'
tags: 网络协议
---

>DNS

mdns即多播dns，mDNS主要实现了在没有传统DNS服务器的情况下使用局域网的主机实现相互发现和通信，使用的端口为5353，遵从dns协议，使用DNS信息的结构。在局域网中，设备与设备之间以前相互通信是需要知道对的ip地址的。大多数情况下，设备的ip不是静态ip地址，而是通过dhcp协议动态分配的ip地址，如何发现设备呢，就需要mdns大显身手了。

### 1、mDNS基于DNS协议

组播地址: 组播地址使用的是D类地址，地址范围为：224.0.0.0—239.255.255.255

### 2、mDNS工作原理

2.mdns工作原理简单描述：
mdns 使用组播地址为： 224.0.0.251 （ipv6： FF02::FB） 端口为5353，mdns是用于局域网内部的，并且主机的域名为.local 结尾,每个进入局域网的主机，如果开启了mDNS服务的话，都会向局域网内的所有主机组播一个消息，我是谁（域名），和我的IP地址是多少。然后其他有mdns服务的主机就会响应，也会告诉你，它是谁（域名），它的IP地址是多少。
当然设备需要服务时，就是使用mdns 查询域名对对应的ip地址，对应的设备收到该报文后同样通过组播方式应答，此时其他主机设备也是可以收到该应答报文，其他主机也会记录域名和ip 以及ttl 等，更新缓存。比如，A主机进入局域网，开启了mDNS 服务，并向mDNS服务注册以下信息：我提供 FTP 服务，我的IP是 192.168.1.101，端口是 21。当B主机进入局域网，并向 B 主机的 mDNS 服务请求，我要找局域网内 FTP 服务器，B主机的 mDNS 就会去局域网内向其他的 mDNS 询问，并且最终告诉你，有一个IP地址为 192.168.1.101，端口号是 21 的主机，也就是 A 主机提供 FTP 服务，所以 B 主机就知道了 A 主机的 IP 地址和端口号了。
大概的原理就是这样子，mDNS提供的服务要远远多于这个，当然服务多但并不复杂。